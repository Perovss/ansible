---

- name: Handle the error if var file current release not exist
  block:
    - name: Includeing OS specific variables for current release 
      include_vars: "{{ansible_distribution | lower}}{{ansible_distribution_major_version}}.yml"
  rescue:
    - name: Includeing OS specific variables for os family
      include_vars: "{{ansible_os_family | lower}}.yml"

- name: Installing packages
  package:
    name: "{{ssmtp_packages}}"
    state: present
  register: package_result
  become: true
  when: ssmtp_packages is defined and ssmtp_packages

- name: configure ssmtp
  template:
    src: '{{item}}.conf.j2'
    dest: '/etc/ssmtp/{{item}}.conf'
    owner: root
    group: mail
    mode: 0640
  become: true
  loop:
    - revaliases
    - ssmtp
  when: package_result.changed
...
